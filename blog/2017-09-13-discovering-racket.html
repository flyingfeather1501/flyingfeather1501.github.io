<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Discovering Racket through making a osu! skin | Kisaragi Hiu</title>
    <meta name="description" content="description">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="author" content="Kisaragi Hiu">
    <meta name="keywords" content="Coding, Programming, Language, LGBT, Blog">
    <link rel="icon" href="/favicon.ico">
    <link rel="canonical" href="https://kisaragi-hiu.com/blog/2017-09-13-discovering-racket.html">
    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js"></script>
    <script>
      WebFont.load({
          google: {
              families: ['Overpass Mono', 'Overpass:200,400,600']
          }
      });
    </script>
    <link rel="stylesheet" href="/css/main.css">
    <link rel="alternate" type="application/atom+xml" href="/feed.xml" title="Atom Feed">
  </head>
  <body>
    <a id="top"></a>
    <div class="container">
      <!--[if lte IE 9]>
        <h1>For the love of god, please stop using IE9. Thanks.</h1>
      <![endif]-->
      <header id="siteheader">
        <div id="logo">
          <a href="/">
            <img src="/static/avatar.png" alt="Kisaragi Hiu"/>
          </a>
          <h1>Kisaragi&nbsp;Hiu</h1>
        </div>
        <nav>
          <a href="/">Blog</a>
          <a href="/projects.html">Projects</a>
          <a href="/about.html">About</a>
        </nav>
      </header>

      <div id="content" class="">

        <header class=""><h2 class="title mb-0"><a href="/blog/2017-09-13-discovering-racket.html" class="text-primary">Discovering Racket through making a osu! skin</a></h2><p class="date">2017/09/13</p><p class="category">C: <a href="/category/meta.html">Meta</a></p></header>

        <root><p>In around March this year, I started trying to make my own osu! skin, or at least mix a skin for my own use.<br/>I started with the <a href="https://osu.ppy.sh/forum/t/454986">Emilia (Re:0) skin by Beatstatic</a>, with a git repo to track my changes, and copied the hitcircles from <a href="https://osu.ppy.sh/forum/t/300001">Clear Skin Ultra 2.4</a> (I like its hitcircle design a lot).</p><p>Then I stumbled across <a href="https://www.youtube.com/watch?v=Yih6pz09Z1A">a font made for the I script in Re:0</a> in April, and started wanting to learn the script for the sake of it. As part of the practice, I decided why not make osu!'s elements in the Re:0 writing system? So I made a new folder in my mix skin, then opened Blender to make the elements, because that's the only tool I was comfortable with using. (I've since learned to use Inkscape more.)</p><p>Making osu! skin elements with Blender is weird. I am putting multiple elements in the same file and adding a different camera for each of them, binding the cameras onto markers, and so I wondered if there's some way to render every marker and maybe name the output with the marker.<br/>After a bit of Googling, I saw an answer by <code>p2or</code> on StackExchange that fits my needs perfectly. (I added the first two comments.)</p><div class="highlight"><table class="sourcetable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="source"><pre><span></span><span class="c1"># by p2or on Blender StackExchange</span>
<span class="c1"># https://blender.stackexchange.com/questions/23121</span>
<span class="kn">import</span> <span class="nn">bpy</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># get the scene</span>
<span class="n">scn</span> <span class="o">=</span> <span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">scene</span>

<span class="c1"># get the output path</span>
<span class="n">output_path</span> <span class="o">=</span> <span class="n">scn</span><span class="o">.</span><span class="n">render</span><span class="o">.</span><span class="n">filepath</span>

<span class="c1"># iterate through markers and render</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">scn</span><span class="o">.</span><span class="n">timeline_markers</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">frame</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">frame</span>
    <span class="n">marker_name</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">name</span>
    <span class="n">scn</span><span class="o">.</span><span class="n">frame_set</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
    <span class="n">scn</span><span class="o">.</span><span class="n">render</span><span class="o">.</span><span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="n">marker_name</span> <span class="o">+</span> <span class="s2">".jpg"</span><span class="p">)</span>
    <span class="n">bpy</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">render</span><span class="o">.</span><span class="n">render</span><span class="p">(</span> <span class="n">write_still</span><span class="o">=</span><span class="bp">True</span> <span class="p">)</span>

<span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">render</span><span class="o">.</span><span class="n">filepath</span> <span class="o">=</span> <span class="n">output_path</span>
</pre></div></td></tr></tbody></table></div><p>With that, I was able to hack together a shell script to render all blend files. Blender also only allows one resolution per scene, so I had to write some post processing functions that resize some images for me, as well as a sort of interface to them through the file names.</p><p>Later in June, I decided to also cover the hitcircles and other elements, and eventually removed all assets not made by me. I also purged all of those out of the git repository; in hindsight, I actually regret that a bit. While refactoring that, I also wanted to do something about the ugly shell script, and I started looking around for different languages.</p><p>I thought about <a href="http://xon.sh/">Xonsh</a>, Python, <a href="https://scsh.net/"><code>scsh</code></a>, the <a href="https://github.com/michaelmacinnis/oh"><code>oh</code></a> shell, and some others, but:</p><ul><li><code>oh</code>: I don't really understand. At least not yet.</li><li>Python: I don't like doing shell script-y stuff in Python currently. Previously I had ported my <code>randomwallpaper</code> script to Python, and it didn't feel better than Bash. This is purely my issue.</li><li>Xonsh: Looks very interesting, but I got stuck trying to figure out how I should parse command line arguments.</li><li><code>scsh</code>: A full language + some shell-isms, sort of like Xonsh. Project feels kind of inactive though.</li></ul><p>So I just gave up and stayed with Bash, and tried to improve the script further; but the "Scheme shell" idea seemed really interesting to me, so I decided to Google for "Scheme shell" and see what I'd get. Racket showed up in the results, and I met Racket for the first time. It actually looks great!</p><p>From there I started with the <a href="http://docs.racket-lang.org/quick/index.html">Quick Intro</a> by Matthew Flatt, and am now trying to learn Racket. Along the way I have seen Pollen, and wrote a self introduction for school in it; and Frog, which I now build this blog with. I'm still very new — I'm not exactly trying hard on anything — but I have definitely stumbled across a very powerful tool.</p><p>About the osu! skin, it's now released as <a href="https://osu.ppy.sh/forum/t/630525/start=0">Retome (currently 0.4)</a> on the osu! forum.</p></root>
        </div>

      <footer>
        <div id="footer-sep">・・・</div>
        <div class="page-navigation "><a href="/blog/2017-09-24-pollen.html">&lt; Moving the blog, again</a><a href="/blog/2017-09-12-termux-and-linux-deploy.html">&gt; 在Android上用Frog</a></div>
        <p>I don't necessarily know what I'm talking about.</p>
        <ul><li><a href="/feeds.html">Atom / RSS</a> (<a href="/feeds/all.atom.xml">direct link</a>)</li>
<li><a href="https://twitter.com/flyin1501" class="">Twitter</a></li>
<li><a href="https://github.com/kisaragi-hiu" class="">Github</a></li>
<li><a href="https://gitlab.com/kisaragi-hiu" class="">Gitlab.com</a></li>
<li><a href="https://git.sr.ht/~kisaragi_hiu/">Sourcehut</a></li>
<li><a href="https://youtube.com/channel/UCl_hsqcvdX0XdgBimRQ6R3A" class="">Youtube</a></li>
<li><a href="https://www.nicovideo.jp/user/38995186" class="">niconico</a></li></ul>
        <p>
          <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
           <img alt="Creative Commons License"
                style="border-width:0"
                src="/static/cc-by-sa-88x31.png" />
          </a>
        </p>
        <p>Posts are licensed under a <a href="http://creativecommons.org/licenses/by-sa/4.0/">CC-BY-SA 4.0 International</a> license.</p>
<p><a href="https://github.com/kisaragi-hiu/kisaragi-hiu.com">Source code</a> is licensed under MIT. See <a href="https://github.com/kisaragi-hiu/kisaragi-hiu.com/blob/source/LICENSE.md" rel="license">LICENSE.md</a> for details.</p>
<p>© Kisaragi Hiu 2017~2019. GPG fingerprint: /KisaragiHiu.gpgBCC74B1041D4B7D7CC8BF40240ECBEAEA8775FC2</p>
      </footer>
    </div>
  </body>
</html>